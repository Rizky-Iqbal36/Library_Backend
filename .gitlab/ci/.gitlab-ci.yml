image: docker:latest

stages:
  - build
  - test

variables:
  DOCKER_DRIVER: overlay
  DOCKER_HOST: tcp://docker:2375/

before_script:
  - docker info
  - apk update
  - apk upgrade
  - apk add python python-dev py-pip build-base
  - pip install docker-compose

services:
  - name: docker:dind

include:
  - local: '.gitlab/ci/build-stage.gitlab-ci.yml'
  - local: '.gitlab/ci/test-stage.gitlab-ci.yml'
